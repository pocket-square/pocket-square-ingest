
Шпионские штучки в Wolfram Language, или как спрятать в картинке всё что угодно / Блог компании Wolfram Research / Хабрахабр
TM Feed
Хабрахабр
Geektimes
Тостер
Мой круг
Фрилансим
Хабрахабр
Публикации
Хабы
Компании
Пользователи
Песочница
Войти
Регистрация
Wolfram Research
            Wolfram Language, Mathematica, Wolfram Alpha и др.
        
44,80
рейтинг
Профиль
89
Блог
0
Вакансии
538
Подписчики
       29 июля 2015 в 12:59 
    
Разработка →
Шпионские штучки в Wolfram Language, или как спрятать в картинке всё что угодно
перевод
Обработка изображений*, 
          Криптография*, 
          Занимательные задачки, 
          Алгоритмы*, 
          Блог компании Wolfram Research
Перевод поста Джона Маклуна (Jon McLoone) "Doing Spy Stuff with Mathematica".
Код, приведенный в статье, можно скачать здесь.
Выражаю огромную благодарность Кириллу Гузенко  KirillGuzenko за помощь в переводе.Я читал о IT проблемах недавно арестованных, как заявлялось, русских шпионов. Говорилось, что они пользовались не самыми надёжными инструментами цифровой стеганографии (вики). И мне стало интересно — насколько быстро я смогу реализовать стеганографию через цифровые изображения в Mathematica, используя метод, известный как "вставка младшего бита" (least significant bit insertion).

Идея стеганографии основывается на том, чтобы спрятать сообщения в какой-то другой информации таким образом, чтобы никто факта коммуникации не заметил. Само слово происходит от латино-греческий комбинации, означающей «скрытное письмо»; данным термином назывался процесс нанесения секретного сообщения на лысую голову человека, на которой затем отрастали волосы и, тем самым, прятали сообщение. В случае цифровой стеганографии всё делается посредством математики.

Первое, что мы должны сделать, это выбрать какое-нибуть невинно выглядящее изображение, чтобы передать его нашим шпионским боссам, возможно, через какой-то общественный онлайн форум. Эта картинка не должна вызвать подозрений, если мы разместим её на дискуссионном сайте о птицеводстве:

Удивительно, однако в это изображение возможно встроить другое, большее по размеру полноцветное изображение и получить его обратно с помощью десятка строк кода в Mathematica.

Ключевая идея — использовать младшие биты в каждом цветовом канале каждого пикселя в качестве места, в котором спрятана информация. Мы начнём с того, что присвоим всем этим битам значение 0, применяя к каждому байту через And двоичное слово 11111110. 

Мы должны заставить Mathematica использовать строго 8 бит на канал, потому что она по умолчанию работает в гораздо более точном цветовом пространстве, то есть будем использовать служебное слово “Byte” в некоторых места нашего кода.

В достаточно сложных изображениях человеческий глаз не сможет обнаружить потерю информации. То есть то, что некоторый цветовой канал отдельного пикселя стал темнее или светлее чем раньше на 1/256 обнаружить просто невозможно.

Даже если вычесть усеченный вариант из оригинала, чтобы показать только значения разностей, то всё равно ничего не разглядеть, разве только если у вас весьма зоркий взгляд и очень хороший монитор.

И только если выкрутить контраст на максимум, то мы увидим, что разница не равна нулю.

Далее мы должны преобразовать наше секретное послание в последовательность битов и вставить их в обнулённые биты в изображении-носителе. Получается по биту на канал, то есть по три на пиксель для RGB изображения.

Для кодирования символов в соответствующие им номера в ASCII будем использовать функцию ToCharacterCode:

Затем мы получим их двоичные представления, выдерживая при этом по 8 бит на число, добавляя при необходимости нули в начале (иначе мы не будем знать, где кончается один байт и начинается другой).

Затем дополним список нулями, чтобы сровняться с общим количеством значений каналов пикселей, в которых мы будем прятать информацию (ширина * высота изображения * 3 канала RGB). Теперь, когда у нас есть нужное количество бит, мы преобразуем данные в соответствии с разрешением изображения и добавим их в изображение-носитель с очищенными битами.

Вот все эти операции вместе:

Для совершения обратного процесса мы должны взять младшие биты из каждого канала пикселя и сгруппировать их в слова по 8 бит, а затем сконвертировать их обратно в текст.

Давайте протестируем:

И обратный процесс:

Экспортировать изображение следует в формат без потерь, такой, как PNG, с оригинальным размером изображения. Любое преобразование в формат с потерями, такой как JPG, или изменения в масштабе уничтожает информацию в младших битах, где мы храним наше секретное сообщение.

Изображение курицы Матильды состоит из 450*450 пикселей и имеет три цветовых канала. Это означает, что мы можем передать 450*450*3/8 символов. Более 75 000. Более чем достаточно, чтобы передать весь текст Приключений Алисы в стране чудес.

Мы можем добавить информации не больше, чем удалили. Файл по-прежнему будет такого же размера и визуально точно таким же.

По сути, в среднем половина пиксельных каналов имеют те же значения, что и в оригинальном изображении, около четверти значений пиксельных каналов на один бит меньше оригинала, у примерно четверти на один бит больше, то есть наше изображение ближе к оригиналу, чем усечённая версия.

Мы получаем решение для передачи любой информации, которую можно представить в 8-битной кодировке ASCII. Mathematica для подобных задач содержит в себе набор инструментов, так что для передачи сообщения, состоящего из более богатого набора символов, мы можем поступить так:

Мы можем использовать преобразование в ASCII для вставки файлов или данных в специальных форматах. Например, мы можем вставить изображение. Тут мы импортируем файл PNG, а затем перекодируем его в строку ASCII формата JPG.

Эта строка, благодаря сжатию JPG, содержит лишь 32000 символов, несколько меньше текста про Алису — удивительно, как легко спрятать целое изображение! Мы можем экспортировать изображение в любой формат без потерь; важно только то, что секретное изображение закодировано в JPG, и при декодировании и интерпретации это следует учитывать.

Изображение-носитель по прежнему выглядит для нас таким же, хотя в нём теперь скрыто секретное изображение агента H и агента B:

Ничто из приведённого выше не является безопасным с точки зрения криптографии; это лишь способ незаметно передать информацию. Криптографические методы должны быть применены к самому секретному сообщению перед его вставкой в изображение-носитель. И, конечно, ничто из этого не поможет, если вы не уверены в получателе, который, возможно, уже находится под наблюдением, или который достаточно «сообразителен» для того, чтобы попросить агента ФБР под прикрытием следить за вашим ноутбуком.
wolfram language, 
wolfram mathematica, 
стеганография, 
шпионские штучки
↑
+19
↓
21,8k
Добавить в избранное
181
Выберите рекомендации для отправки автору:
Указан только блог
Орфографические ошибки
Пунктуационные ошибки
Отступы
Текст-простыня
Короткие предложения
Смайлики
Много форматирования
Картинки
Ссылки
Отправить
Автор:
@OsipovRoman
Джон Маклун (Jon McLoone)
Wolfram Research
рейтинг
44,80
             Wolfram Language, Mathematica, Wolfram Alpha и др.
          
Сайт
Сайт
Facebook
Twitter
Вконтакте
Похожие публикации
+1
Wolfram Language (Mathematica) на русском языке… или продвинутое задание функций
14,8k
31
15
+15
Новое в Wolfram Language: функция TimelinePlot для создания временной шкалы
8,7k
51
10
+43
Моделирование пандемий с помощью языка Wolfram Language (системы Mathematica 10) на примере лихорадки Эбола
34,3k
150
42
Пометьте топик понятными вам метками, если хотите
Метки лучше разделять запятой. Например: общение, социальные сети, myspace.com, подростки, мердок
 или закрыть
      Комментарии (3)
      
    
SneakyJoe
            29 июля 2015 в 16:49
          
+1
↑
↓
          А есть ещё и такие штуки как rarjpeg. Тоже способ начального уровня сокрытия.
        
Alexufo
            29 июля 2015 в 21:15
          
+1
↑
↓
          есть еще плагин в фотошопе называющийся «Digimarc»
        
boeing777
            29 июля 2015 в 23:05
          
0
↑
↓
          Картинка с увеличенным контрастом разности похожа на результат работы фильтра noise в Photoshop. Интересно, Adobe там тоже что-то закодировали? :)
По делу: для увеличения плотности инкапсуляции можно использовать сокращенный алфавит вместо 8-битного ASCII. Например, base64-кодирование или нечто подобное. Разумеется, такой способ применим только для текста, а не двоичных данных.
        
Только зарегистрированные пользователи могут оставлять комментарии. Войдите, пожалуйста.
Пометьте топик понятными вам метками, если хотите
Метки лучше разделять запятой. Например: общение, социальные сети, myspace.com, подростки, мердок
 или закрыть
УЗНАТЬ БОЛЬШЕ...
Приложения
Wolfram Cloud
Приложение для работы с Wolfram Cloud на iPhone, iPad, Apple Watch. Вся мощь языка Wolfram Language (Mathematica) будет всегда у Вас под рукой.
iOS
Веб-сервис
Wolfram|Alpha
Система генерации подробных ответов и отчетов на вопросы в свободной форме. Wolfram|Alpha работает в тысячах областей: от чистой математики, физики и химии до сведений о людях, погоде, музыке и пр.
Android
iOS
Windows Phone
Веб-сервис
A New Kind of Science (Новый вид науки)
Фундаментальная монография Стивена Вольфрама, посвященная клеточным автоматам и их применению в самых разных областях знаний: от генерации псевдослучайных чисел, до биологии и задач гидродинамики.
iOS
Веб-сервис
Ссылки
Cайт компании Wolfram Research
www.wolfram.com
Сайт Русскоязычной поддержки Wolfram Mathematica®
wolframmathematica.ru
Курсы Wolfram Mathematica®
wolframmathematica.ru
Распространенные ошибки и заблуждения начинающих пользователей Wolfram Mathematica
wolframmathematica.ru
Полнофункциональная триал-версия Mathematica
www.wolfram.com
Полнофункциональная триал-версия SystemModeler
www.wolfram.com
Бесплатный пробный аккаунт Wolfram Programming Cloud
www.wolfram.com
Новости
Launching Wolfram|Alpha Open Code 13 декабря 2016 
Announcing the Fast Introduction for Math Students 12 декабря 2016 
Wolfram Finance Platform 2.3 Now Available 3 декабря 2016 
Launching Wolfram Player for iOS 17 ноября 2016 
My Wolfram Tech Conference 2016 Highlights 8 ноября 2016 
Announcing Wolfram SystemModeler 4.3 27 октября 2016 
Computational Law, Symbolic Discourse and the AI Constitution 26 октября 2016 
gridMathematica Updated for Version 11 Compatibility 26 октября 2016 
Barcelona Wolfram Technology Conference 2016 26 октября 2016 
2016 Wolfram Europe French Tour 26 октября 2016 
Блог на Хабрахабре
Памяти Соломона Голомба (1932-2016): автора регистра сдвига с линейной обратной связью максимальной длины и полиомино  12
«Моя жизнь сквозь призму технологий...» — Стивен Вольфрам  16
Музыка, Mathematica и вычислительная вселенная: автоматическое создание музыки на основе клеточных автоматов  3
Обзор новых возможностей Mathematica 11 и языка Wolfram Language  23
Даты среди цифр числа Пи: некоторые мысли с позиции статистики и нумерологии  22
Кем был Рамануджан?  54
Математические обозначения: Прошлое и будущее  9
Пропорции в искусстве. Есть ли что-то лучше золотого сечения? Исследование более 1 000 000 старых и современных картин  30
Что такое пространство-время на самом деле?  141
Распутывая историю Ады Лавлейс (первого программиста в истории)  27
Самое читаемое
Разработка
Сейчас
Сутки
Неделя
Месяц
+9
What the flask?
2,2k
10
2
+6
Пора играть честно, Microsoft
8,7k
14
240
+9
Книга «В работу с головой. Паттерны успеха от IT-специалиста»
7,9k
51
10
+3
Самые популярные слова в двух терабайтах кода
453
4
12
+19
Async/await это шаг назад для JavaScript'a?
10,6k
78
69
+27
Правильный путь становления безопасника: от ламера до практического эксплойтинга
13,6k
197
16
+19
Async/await это шаг назад для JavaScript'a?
10,6k
78
69
+6
Пора играть честно, Microsoft
8,7k
14
240
+9
Книга «В работу с головой. Паттерны успеха от IT-специалиста»
7,9k
51
10
+26
Экзамен для будущих «русских хакеров» в Московском Политехе
17,8k
140
32
+56
Старикам здесь вполне ещё место: забытые ИT-технологии в строю
34,1k
78
136
+135
Что если в играх использовать видеокарточку для физики, а не для графики
27k
115
179
+36
Один из простых способов улучшить свои навыки программирования — читать чужой код
24,9k
247
33
+34
Пользователи Windows получили возможность работать с openSUSE (и Arch Linux)
23,6k
110
71
+54
Я работаю в ТехЦентре Дойче Банка
22,1k
47
67
+47
Самые востребованные языки программирования 2016
63,6k
112
152
+96
Писать веб-сайты на ассемблере полезно и приятно
58,4k
268
428
+107
Как проектируют ненастоящие программисты
54,4k
158
257
+75
Уязвимость Viber, позволяющая прослушивать чужой разговор
49,5k
58
33
+92
Почему Hackintosh уже актуален. Развенчание мифов
46,6k
485
430
Интересные публикации
Хабрахабр
Гиктаймс
Национальные домены vs один общий домен: кейс 841% роста от международного бренда  4
What the flask?  2
Как изучать английскую грамматику БЕЗ упражнений. Творческий подход — внедрение юнитов в главы своей книги  17
3D-моделирование и гибкая эндоскопия  4
Как рождались IT-династии в Беларуси  0
Краткий обзор нововведений в Laravel 5.4  35
Южная Корея разрабатывает свой Hyperloop  26
Как получаются дети [18+]  60
Пользовательские исследования в играх  2
Китай объявил о 14-месячной облаве на VPN, используемых для обхода национального файервола  55
Войти
Регистрация
Разделы
Публикации
Хабы
Компании
Пользователи
Q&A
Песочница
Инфо
О сайте
Правила
Помощь
Соглашение
Услуги
Реклама
Тарифы
Контент
Семинары
Разное
iOS приложение
Android приложение
Помощь стартапам
© TM
Служба поддержки
Мобильная версия
